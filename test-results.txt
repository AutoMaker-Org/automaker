
[1m[46m RUN [49m[22m [36mv4.0.16 [39m[90m/home/oxtsotsi/Webrnds/DevFlow/apps/server[39m

 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould extract JSON with features array[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould extract JSON with multiple features[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould extract JSON with nested objects and arrays[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould handle JSON with whitespace and newlines[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould extract JSON when features array is empty[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould not match content without features key[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould not match content without JSON structure[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould extract JSON when features key appears multiple times[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould handle JSON with escaped quotes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON extraction regex[2m > [22mshould extract JSON with complex nested structure[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON parsing validation[2m > [22mshould parse valid feature JSON structure[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON parsing validation[2m > [22mshould handle features with optional fields[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/parse-and-create-features.test.ts[2m > [22mapp-spec/parse-and-create-features.ts - JSON extraction[2m > [22mJSON parsing validation[2m > [22mshould handle features with dependencies[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/events.test.ts[2m > [22mevents.ts[2m > [22mcreateEventEmitter[2m > [22mshould emit events to single subscriber[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/events.test.ts[2m > [22mevents.ts[2m > [22mcreateEventEmitter[2m > [22mshould emit events to multiple subscribers[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/events.test.ts[2m > [22mevents.ts[2m > [22mcreateEventEmitter[2m > [22mshould support unsubscribe functionality[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/events.test.ts[2m > [22mevents.ts[2m > [22mcreateEventEmitter[2m > [22mshould handle errors in subscribers without crashing[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/events.test.ts[2m > [22mevents.ts[2m > [22mcreateEventEmitter[2m > [22mshould emit different event types[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/events.test.ts[2m > [22mevents.ts[2m > [22mcreateEventEmitter[2m > [22mshould handle emitting without subscribers[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/events.test.ts[2m > [22mevents.ts[2m > [22mcreateEventEmitter[2m > [22mshould allow multiple subscriptions and unsubscriptions[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParse[2m > [22mshould parse valid JSON correctly[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParse[2m > [22mshould parse valid JSON arrays[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParse[2m > [22mshould parse valid JSON objects[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParse[2m > [22mshould throw descriptive error for invalid JSON[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParse[2m > [22mshould include context in error message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParse[2m > [22mshould handle empty strings[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParse[2m > [22mshould handle whitespace[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParse[2m > [22mshould preserve type parameter[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParseOrDefault[2m > [22mshould parse valid JSON correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParseOrDefault[2m > [22mshould return default value for invalid JSON[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParseOrDefault[2m > [22mshould return default value for empty string[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParseOrDefault[2m > [22mshould return default value for malformed JSON[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParseOrDefault[2m > [22mshould work with arrays[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/json-parser.test.ts[2m > [22mjson-parser[2m > [22msafeJsonParseOrDefault[2m > [22mshould work with objects[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould detect PowerShell Core on Windows when available
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould fall back to PowerShell on Windows if Core not available
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould fall back to cmd.exe on Windows if no PowerShell
[22m[39m[Terminal] Cleaning up 0 sessions

 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22mauthMiddleware - no API key[2m > [22mshould call next() when no API key is set[32m 20[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22mauthMiddleware - with API key[2m > [22mshould reject request without API key header[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22mauthMiddleware - with API key[2m > [22mshould reject request with invalid API key[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22mauthMiddleware - with API key[2m > [22mshould call next() with valid API key[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22misAuthEnabled[2m > [22mshould return false when no API key is set[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22misAuthEnabled[2m > [22mshould return true when API key is set[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22mgetAuthStatus[2m > [22mshould return disabled status when no API key[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22mgetAuthStatus[2m > [22mshould return enabled status when API key is set[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/auth.test.ts[2m > [22mauth.ts[2m > [22mgetAuthStatus[2m > [22mshould return production mode status when NODE_ENV is production[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mconstructor[2m > [22mshould initialize with empty config when none provided[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mconstructor[2m > [22mshould initialize with provided config[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mconstructor[2m > [22mshould call getName() during initialization[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mvalidateConfig[2m > [22mshould return valid when config exists[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mvalidateConfig[2m > [22mshould return invalid when config is undefined[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mvalidateConfig[2m > [22mshould return valid for empty config object[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mvalidateConfig[2m > [22mshould include warnings array in result[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msupportsFeature[2m > [22mshould support 'tools' feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msupportsFeature[2m > [22mshould support 'text' feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msupportsFeature[2m > [22mshould not support unknown features[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msupportsFeature[2m > [22mshould be case-sensitive[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mgetConfig[2m > [22mshould return current config[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mgetConfig[2m > [22mshould return same reference[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msetConfig[2m > [22mshould merge partial config with existing config[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msetConfig[2m > [22mshould override existing fields[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msetConfig[2m > [22mshould accept empty object[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msetConfig[2m > [22mshould handle multiple updates[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22msetConfig[2m > [22mshould preserve other fields when updating one field[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mabstract methods[2m > [22mshould require getName implementation[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mabstract methods[2m > [22mshould require executeQuery implementation[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mabstract methods[2m > [22mshould require detectInstallation implementation[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/base-provider.test.ts[2m > [22mbase-provider.ts[2m > [22mabstract methods[2m > [22mshould require getAvailableModels implementation[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould detect user shell on macOS
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould fall back to zsh on macOS if user shell not available
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould fall back to bash on macOS if zsh not available
[22m[39m[Terminal] Cleaning up 0 sessions

 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould handle empty feature list[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould handle features with no dependencies[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould order features by dependencies (simple chain)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould respect priority within same dependency level[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould use default priority of 2 when not specified[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould detect missing dependencies[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould detect blocked features (incomplete dependencies)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould not block features whose dependencies are verified[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould detect circular dependencies (simple cycle)[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould detect circular dependencies (multi-node cycle)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould handle mixed valid and circular dependencies[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould handle complex dependency graph[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould handle features with empty dependencies array[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould track multiple blocking dependencies[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mresolveDependencies[2m > [22mshould handle self-referencing dependency[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return true for feature with no dependencies[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return true for feature with empty dependencies array[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return true when all dependencies are completed[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return true when all dependencies are verified[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return true when dependencies are mix of completed and verified[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return false when any dependency is in_progress[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return false when any dependency is in backlog[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return false when dependency is missing[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mareDependenciesSatisfied[2m > [22mshould return false when multiple dependencies are incomplete[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould return empty array for feature with no dependencies[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould return empty array for feature with empty dependencies array[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould return empty array when all dependencies are completed[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould return empty array when all dependencies are verified[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould return blocking dependencies in backlog status[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould return blocking dependencies in in_progress status[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould return blocking dependencies in waiting_approval status[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould return all blocking dependencies[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould handle missing dependencies[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/dependency-resolver.test.ts[2m > [22mdependency-resolver.ts[2m > [22mgetBlockingDependencies[2m > [22mshould handle mix of completed, verified, and incomplete dependencies[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould detect user shell on Linux
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould fall back to bash on Linux if user shell not available
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould fall back to sh on Linux if bash not available
[22m[39m[Terminal] Cleaning up 0 sessions

 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssueIdSchema[2m > [22mshould accept valid issue IDs[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssueIdSchema[2m > [22mshould reject invalid issue IDs[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssueIdSchema[2m > [22mshould reject issue IDs with uppercase letters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssueIdSchema[2m > [22mshould reject issue IDs with special characters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssueStatusSchema[2m > [22mshould accept valid status values[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssueStatusSchema[2m > [22mshould reject invalid status values[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssueTypeSchema[2m > [22mshould accept valid type values[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssueTypeSchema[2m > [22mshould reject invalid type values[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssuePrioritySchema[2m > [22mshould accept valid priority values[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssuePrioritySchema[2m > [22mshould reject out of range values[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsIssuePrioritySchema[2m > [22mshould reject non-integer values[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsLabelsSchema[2m > [22mshould accept valid labels array[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsLabelsSchema[2m > [22mshould reject labels exceeding 50 characters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mbeadsLabelsSchema[2m > [22mshould reject more than 10 labels[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mcreateBeadsIssueSchema[2m > [22mshould accept valid input with required fields[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mcreateBeadsIssueSchema[2m > [22mshould accept valid input with all fields[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mcreateBeadsIssueSchema[2m > [22mshould reject missing title[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mcreateBeadsIssueSchema[2m > [22mshould reject title with invalid characters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mcreateBeadsIssueSchema[2m > [22mshould reject title exceeding 200 characters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mcreateBeadsIssueSchema[2m > [22mshould reject invalid priority[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mcreateBeadsIssueSchema[2m > [22mshould reject invalid type[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mupdateBeadsIssueSchema[2m > [22mshould accept valid update with title[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mupdateBeadsIssueSchema[2m > [22mshould accept valid update with multiple fields[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mupdateBeadsIssueSchema[2m > [22mshould reject empty update[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mdeleteBeadsIssueSchema[2m > [22mshould accept valid delete input[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mdeleteBeadsIssueSchema[2m > [22mshould accept valid delete input with force flag[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mdeleteBeadsIssueSchema[2m > [22mshould reject invalid issue ID[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22maddDependencySchema[2m > [22mshould accept valid dependency[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22maddDependencySchema[2m > [22mshould reject invalid dependency type[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mlistBeadsIssuesFiltersSchema[2m > [22mshould accept empty filters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mlistBeadsIssuesFiltersSchema[2m > [22mshould accept status filter[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mlistBeadsIssuesFiltersSchema[2m > [22mshould accept priority range filter[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mlistBeadsIssuesFiltersSchema[2m > [22mshould reject invalid status[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mlistBeadsIssuesFiltersSchema[2m > [22mshould reject unknown properties[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22msearchBeadsIssuesSchema[2m > [22mshould accept valid search query[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22msearchBeadsIssuesSchema[2m > [22mshould accept search with limit[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22msearchBeadsIssuesSchema[2m > [22mshould reject empty query[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22msearchBeadsIssuesSchema[2m > [22mshould reject limit out of range[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mgetStaleIssuesSchema[2m > [22mshould accept empty input[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mgetStaleIssuesSchema[2m > [22mshould accept valid days value[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/beads-validation.test.ts[2m > [22mbeads-validation[2m > [22mgetStaleIssuesSchema[2m > [22mshould reject days out of range[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mdetectShell[2m > [22m[2mshould detect WSL and use appropriate shell
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2misWSL[2m > [22m[2mshould return true if /proc/version contains microsoft
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2misWSL[2m > [22m[2mshould return true if /proc/version contains wsl
[22m[39m[Terminal] Cleaning up 0 sessions

 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mSystem Prompt Constants[2m > [22mshould have non-empty improve system prompt[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mSystem Prompt Constants[2m > [22mshould have non-empty technical system prompt[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mSystem Prompt Constants[2m > [22mshould have non-empty simplify system prompt[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mSystem Prompt Constants[2m > [22mshould have non-empty acceptance system prompt[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mExample Constants[2m > [22mshould have improve examples with input and output[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mExample Constants[2m > [22mshould have technical examples with input and output[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mExample Constants[2m > [22mshould have simplify examples with input and output[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mExample Constants[2m > [22mshould have acceptance examples with input and output[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetEnhancementPrompt[2m > [22mshould return config for improve mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetEnhancementPrompt[2m > [22mshould return config for technical mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetEnhancementPrompt[2m > [22mshould return config for simplify mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetEnhancementPrompt[2m > [22mshould return config for acceptance mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetEnhancementPrompt[2m > [22mshould handle case-insensitive mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetEnhancementPrompt[2m > [22mshould fall back to improve for invalid mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetEnhancementPrompt[2m > [22mshould fall back to improve for empty string[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetSystemPrompt[2m > [22mshould return correct system prompt for each mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetExamples[2m > [22mshould return correct examples for each mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetExamples[2m > [22mshould return arrays with example objects[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mbuildUserPrompt[2m > [22mshould build prompt with examples by default[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mbuildUserPrompt[2m > [22mshould build prompt without examples when includeExamples is false[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mbuildUserPrompt[2m > [22mshould include all examples for improve mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mbuildUserPrompt[2m > [22mshould include separator between examples[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mbuildUserPrompt[2m > [22mshould work with all enhancement modes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mbuildUserPrompt[2m > [22mshould preserve the original text exactly[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22misValidEnhancementMode[2m > [22mshould return true for valid modes[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22misValidEnhancementMode[2m > [22mshould return false for invalid modes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetAvailableEnhancementModes[2m > [22mshould return all four enhancement modes[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/enhancement-prompts.test.ts[2m > [22menhancement-prompts.ts[2m > [22mgetAvailableEnhancementModes[2m > [22mshould return an array[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2misWSL[2m > [22m[2mshould return true if WSL_DISTRO_NAME is set
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2misWSL[2m > [22m[2mshould return true if WSLENV is set
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2misWSL[2m > [22m[2mshould return false if not in WSL
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2misWSL[2m > [22m[2mshould return false if error reading /proc/version
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetPlatformInfo[2m > [22m[2mshould return platform information
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould create a new terminal session
[22m[39m[Terminal] Creating session term-1766695791302-in8zrnla6 with shell: /bin/bash in /test/dir
[Terminal] Session term-1766695791302-in8zrnla6 created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould create a new terminal session
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould use default cols and rows if not provided
[22m[39m[Terminal] Creating session term-1766695791306-35y6faztd with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791306-35y6faztd created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould use default cols and rows if not provided
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould fall back to home directory if cwd does not exist
[22m[39m[Terminal] Creating session term-1766695791308-3jv7eyecg with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791308-3jv7eyecg created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould fall back to home directory if cwd does not exist
[22m[39m[Terminal] Cleaning up 1 sessions

 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22misAvailable[2m > [22mshould return true when Claude CLI is available[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22misAvailable[2m > [22mshould return false when Claude CLI is not available[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22misAvailable[2m > [22mshould return false on error[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22misAvailable[2m > [22mshould use 'where' command on Windows[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mstripAnsiCodes[2m > [22mshould strip ANSI color codes from text[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mstripAnsiCodes[2m > [22mshould handle text without ANSI codes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould parse duration format with hours and minutes[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould parse duration format with only minutes[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould parse simple time format (AM)[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould parse simple time format (PM)[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould parse date format with month, day, and time[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould parse date format with comma separator[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould handle 12am correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould handle 12pm correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseResetTime[2m > [22mshould return default reset time for unparseable text[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mgetDefaultResetTime[2m > [22mshould return session default (5 hours from now)[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mgetDefaultResetTime[2m > [22mshould return weekly default (next Monday at noon)[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseSection[2m > [22mshould parse section with percentage left[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseSection[2m > [22mshould parse section with percentage used[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseSection[2m > [22mshould return zero percentage when section not found[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseSection[2m > [22mshould strip timezone from reset text[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseSection[2m > [22mshould handle case-insensitive section matching[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseUsageOutput[2m > [22mshould parse complete usage output[32m 12[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseUsageOutput[2m > [22mshould handle output with ANSI codes[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseUsageOutput[2m > [22mshould handle Opus section name[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mparseUsageOutput[2m > [22mshould set default values for missing sections[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mexecuteClaudeUsageCommandMac[2m > [22mshould execute expect script and return output[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mexecuteClaudeUsageCommandMac[2m > [22mshould handle authentication errors[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mexecuteClaudeUsageCommandMac[2m > [22mshould handle timeout[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mexecuteClaudeUsageCommandWindows[2m > [22mshould use node-pty on Windows and return output[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mexecuteClaudeUsageCommandWindows[2m > [22mshould send escape key after seeing usage data[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mexecuteClaudeUsageCommandWindows[2m > [22mshould handle authentication errors on Windows[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/claude-usage-service.test.ts[2m > [22mclaude-usage-service.ts[2m > [22mexecuteClaudeUsageCommandWindows[2m > [22mshould handle timeout on Windows[32m 1[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould fall back to home directory if cwd is not a directory
[22m[39m[Terminal] Creating session term-1766695791309-l1xy0zgga with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791309-l1xy0zgga created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould fall back to home directory if cwd is not a directory
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould fix double slashes in path
[22m[39m[Terminal] Creating session term-1766695791311-qc42lwvm5 with shell: /bin/bash in /test/dir
[Terminal] Session term-1766695791311-qc42lwvm5 created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould fix double slashes in path
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould preserve WSL UNC paths
[22m[39m[Terminal] Creating session term-1766695791313-58df17auu with shell: /bin/bash in //wsl$/Ubuntu/home
[Terminal] Session term-1766695791313-58df17auu created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould preserve WSL UNC paths
[22m[39m[Terminal] Cleaning up 1 sessions

 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mClaude models (claude-* prefix)[2m > [22mshould return ClaudeProvider for claude-opus-4-5-20251101[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mClaude models (claude-* prefix)[2m > [22mshould return ClaudeProvider for claude-sonnet-4-20250514[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mClaude models (claude-* prefix)[2m > [22mshould return ClaudeProvider for claude-haiku-4-5[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mClaude models (claude-* prefix)[2m > [22mshould be case-insensitive for claude models[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mClaude aliases[2m > [22mshould return ClaudeProvider for 'haiku'[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mClaude aliases[2m > [22mshould return ClaudeProvider for 'sonnet'[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mClaude aliases[2m > [22mshould return ClaudeProvider for 'opus'[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mClaude aliases[2m > [22mshould be case-insensitive for aliases[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mUnknown models[2m > [22mshould default to ClaudeProvider for unknown model[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mUnknown models[2m > [22mshould warn when defaulting to Claude[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mUnknown models[2m > [22mshould handle empty string[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mUnknown models[2m > [22mshould default to ClaudeProvider for gpt models (not supported)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderForModel[2m > [22mUnknown models[2m > [22mshould default to ClaudeProvider for o-series models (not supported)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetAllProviders[2m > [22mshould return array of all providers[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetAllProviders[2m > [22mshould include ClaudeProvider[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetAllProviders[2m > [22mshould return exactly 1 provider[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetAllProviders[2m > [22mshould create new instances each time[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mcheckAllProviders[2m > [22mshould return installation status for all providers[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mcheckAllProviders[2m > [22mshould call detectInstallation on each provider[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mcheckAllProviders[2m > [22mshould return correct provider names as keys[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderByName[2m > [22mshould return ClaudeProvider for 'claude'[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderByName[2m > [22mshould return ClaudeProvider for 'anthropic'[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderByName[2m > [22mshould be case-insensitive[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderByName[2m > [22mshould return null for unknown provider[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderByName[2m > [22mshould return null for empty string[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetProviderByName[2m > [22mshould create new instance each time[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetAllAvailableModels[2m > [22mshould return array of models[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetAllAvailableModels[2m > [22mshould include models from all providers[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetAllAvailableModels[2m > [22mshould return models with required fields[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/provider-factory.test.ts[2m > [22mprovider-factory.ts[2m > [22mgetAllAvailableModels[2m > [22mshould include Claude models[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2minitAllowedPaths[2m > [22m[2mshould load ALLOWED_ROOT_DIRECTORY if set
[22m[39m[Security] âœ“ ALLOWED_ROOT_DIRECTORY configured: /projects

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2minitAllowedPaths[2m > [22m[2mshould include DATA_DIR if set
[22m[39m[Security] âš ï¸  ALLOWED_ROOT_DIRECTORY not set - allowing access to all paths
[Security] âœ“ DATA_DIR configured: /data/dir

 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22minitAllowedPaths[2m > [22mshould load ALLOWED_ROOT_DIRECTORY if set[32m 110[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould handle data events from PTY
[22m[39m[Terminal] Creating session term-1766695791317-0ysgdfwcc with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791317-0ysgdfwcc created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould handle data events from PTY
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould handle exit events from PTY
[22m[39m[Terminal] Creating session term-1766695791320-qewqw261w with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791320-qewqw261w created successfully
[Terminal] Session term-1766695791320-qewqw261w exited with code 0

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcreateSession[2m > [22m[2mshould handle exit events from PTY
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2minitAllowedPaths[2m > [22m[2mshould include both ALLOWED_ROOT_DIRECTORY and DATA_DIR if both set
[22m[39m[Security] âœ“ ALLOWED_ROOT_DIRECTORY configured: /projects
[Security] âœ“ DATA_DIR configured: /data

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mwrite[2m > [22m[2mshould write data to existing session
[22m[39m[Terminal] Creating session term-1766695791321-svodm2yue with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791321-svodm2yue created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mwrite[2m > [22m[2mshould write data to existing session
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2minitAllowedPaths[2m > [22m[2mshould return empty array when no paths configured
[22m[39m[Security] âš ï¸  ALLOWED_ROOT_DIRECTORY not set - allowing access to all paths

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mwrite[2m > [22m[2mshould return false for non-existent session
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mresize[2m > [22m[2mshould resize existing session
[22m[39m[Terminal] Creating session term-1766695791324-xsst4xbaq with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791324-xsst4xbaq created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mresize[2m > [22m[2mshould resize existing session
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mresize[2m > [22m[2mshould return false for non-existent session
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2misPathAllowed[2m > [22m[2mshould allow paths within ALLOWED_ROOT_DIRECTORY
[22m[39m[Security] âœ“ ALLOWED_ROOT_DIRECTORY configured: /allowed/project

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2misPathAllowed[2m > [22m[2mshould allow all paths when no restrictions are configured
[22m[39m[Security] âš ï¸  ALLOWED_ROOT_DIRECTORY not set - allowing access to all paths

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2misPathAllowed[2m > [22m[2mshould allow all paths when DATA_DIR is set but ALLOWED_ROOT_DIRECTORY is not
[22m[39m[Security] âš ï¸  ALLOWED_ROOT_DIRECTORY not set - allowing access to all paths
[Security] âœ“ DATA_DIR configured: /data

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2mvalidatePath[2m > [22m[2mshould return resolved path for allowed paths
[22m[39m[Security] âœ“ ALLOWED_ROOT_DIRECTORY configured: /allowed

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2mvalidatePath[2m > [22m[2mshould throw error for paths outside allowed directories
[22m[39m[Security] âœ“ ALLOWED_ROOT_DIRECTORY configured: /allowed

 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetAutomakerDir[2m > [22mshould return path to .automaker directory[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetAutomakerDir[2m > [22mshould handle paths with trailing slashes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetFeaturesDir[2m > [22mshould return path to features directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetFeatureDir[2m > [22mshould return path to specific feature directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetFeatureDir[2m > [22mshould handle feature IDs with special characters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetFeatureImagesDir[2m > [22mshould return path to feature images directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetBoardDir[2m > [22mshould return path to board directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetImagesDir[2m > [22mshould return path to images directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetWorktreesDir[2m > [22mshould return path to worktrees directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetAppSpecPath[2m > [22mshould return path to app_spec.txt file[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetBranchTrackingPath[2m > [22mshould return path to active-branches.json file[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mensureAutomakerDir[2m > [22mshould create automaker directory and return path[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mensureAutomakerDir[2m > [22mshould succeed if directory already exists[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetGlobalSettingsPath[2m > [22mshould return path to settings.json in data directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetGlobalSettingsPath[2m > [22mshould handle paths with trailing slashes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetCredentialsPath[2m > [22mshould return path to credentials.json in data directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetCredentialsPath[2m > [22mshould handle paths with trailing slashes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetProjectSettingsPath[2m > [22mshould return path to settings.json in project .automaker directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mgetProjectSettingsPath[2m > [22mshould handle paths with trailing slashes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mensureDataDir[2m > [22mshould create data directory and return path[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mensureDataDir[2m > [22mshould succeed if directory already exists[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/automaker-paths.test.ts[2m > [22mautomaker-paths.ts[2m > [22mensureDataDir[2m > [22mshould create nested directories[32m 1[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2mvalidatePath[2m > [22m[2mshould not throw error for any path when no restrictions are configured
[22m[39m[Security] âš ï¸  ALLOWED_ROOT_DIRECTORY not set - allowing access to all paths

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2mvalidatePath[2m > [22m[2mshould resolve relative paths within allowed directory
[22m[39m[Security] âœ“ ALLOWED_ROOT_DIRECTORY configured: /home/oxtsotsi/Webrnds/DevFlow/apps/server

[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2mgetAllowedPaths[2m > [22m[2mshould return array of allowed paths
[22m[39m[Security] âœ“ ALLOWED_ROOT_DIRECTORY configured: /projects
[Security] âœ“ DATA_DIR configured: /data

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mresize[2m > [22m[2mshould handle resize errors
[22m[39m[Terminal] Creating session term-1766695791326-if2b63yhs with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791326-if2b63yhs created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mresize[2m > [22m[2mshould handle resize errors
[22m[39m[Terminal] Cleaning up 1 sessions

 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetName[2m > [22mshould return 'claude' as provider name[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould execute simple text query[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould pass correct options to SDK[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould use default allowed tools when not specified[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould enable sandbox by default[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould pass abortController if provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould handle conversation history with sdkSessionId using resume option[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould handle array prompt (with images)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould use maxTurns default of 20[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mexecuteQuery[2m > [22mshould handle errors during execution and rethrow[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mdetectInstallation[2m > [22mshould return installed with SDK method[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mdetectInstallation[2m > [22mshould detect ANTHROPIC_API_KEY[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mdetectInstallation[2m > [22mshould return hasApiKey false when no keys present[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould return 4 Claude models[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould include Claude Opus 4.5[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould include Claude Sonnet 4[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould include Claude 3.5 Sonnet[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould include Claude Haiku 4.5[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould mark Opus as default[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould all support vision and tools[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould have correct context windows[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mgetAvailableModels[2m > [22mshould have modelString field matching id[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22msupportsFeature[2m > [22mshould support 'tools' feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22msupportsFeature[2m > [22mshould support 'text' feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22msupportsFeature[2m > [22mshould support 'vision' feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22msupportsFeature[2m > [22mshould support 'thinking' feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22msupportsFeature[2m > [22mshould not support 'mcp' feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22msupportsFeature[2m > [22mshould not support 'cli' feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22msupportsFeature[2m > [22mshould not support unknown features[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mvalidateConfig[2m > [22mshould validate config from base class[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mconfig management[2m > [22mshould get and set config[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/providers/claude-provider.test.ts[2m > [22mclaude-provider.ts[2m > [22mconfig management[2m > [22mshould merge config updates[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/security.test.ts[2m > [22m[2msecurity.ts[2m > [22m[2mgetAllowedPaths[2m > [22m[2mshould return resolved paths
[22m[39m[Security] âœ“ ALLOWED_ROOT_DIRECTORY configured: /test

 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22minitAllowedPaths[2m > [22mshould include DATA_DIR if set[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22minitAllowedPaths[2m > [22mshould include both ALLOWED_ROOT_DIRECTORY and DATA_DIR if both set[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22minitAllowedPaths[2m > [22mshould return empty array when no paths configured[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22misPathAllowed[2m > [22mshould allow paths within ALLOWED_ROOT_DIRECTORY[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22misPathAllowed[2m > [22mshould allow all paths when no restrictions are configured[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22misPathAllowed[2m > [22mshould allow all paths when DATA_DIR is set but ALLOWED_ROOT_DIRECTORY is not[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22mvalidatePath[2m > [22mshould return resolved path for allowed paths[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22mvalidatePath[2m > [22mshould throw error for paths outside allowed directories[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22mvalidatePath[2m > [22mshould not throw error for any path when no restrictions are configured[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22mvalidatePath[2m > [22mshould resolve relative paths within allowed directory[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22mgetAllowedPaths[2m > [22mshould return array of allowed paths[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/security.test.ts[2m > [22msecurity.ts[2m > [22mgetAllowedPaths[2m > [22mshould return resolved paths[32m 1[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mkillSession[2m > [22m[2mshould kill existing session
[22m[39m[Terminal] Creating session term-1766695791333-gezo9tuxt with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791333-gezo9tuxt created successfully
[Terminal] Session term-1766695791333-gezo9tuxt sending SIGTERM
[Terminal] Session term-1766695791333-gezo9tuxt kill initiated
[Terminal] Session term-1766695791333-gezo9tuxt still alive after SIGTERM, sending SIGKILL

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mkillSession[2m > [22m[2mshould kill existing session
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mkillSession[2m > [22m[2mshould return false for non-existent session
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mkillSession[2m > [22m[2mshould handle kill errors
[22m[39m[Terminal] Creating session term-1766695791335-307c541rj with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791335-307c541rj created successfully
[Terminal] Session term-1766695791335-307c541rj sending SIGTERM

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mkillSession[2m > [22m[2mshould handle kill errors
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetSession[2m > [22m[2mshould return existing session
[22m[39m[Terminal] Creating session term-1766695791336-90xreat24 with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791336-90xreat24 created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetSession[2m > [22m[2mshould return existing session
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetSession[2m > [22m[2mshould return undefined for non-existent session
[22m[39m[Terminal] Cleaning up 0 sessions

 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould resolve 'haiku' alias to full model string[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould resolve 'sonnet' alias to full model string[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould resolve 'opus' alias to full model string[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould treat unknown models as falling back to default[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould pass through full Claude model strings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould return default model when modelKey is undefined[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould return custom default model when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould return default for unknown model key[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mresolveModelString[2m > [22mshould handle empty string[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mgetEffectiveModel[2m > [22mshould prioritize explicit model over session and default[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mgetEffectiveModel[2m > [22mshould use session model when explicit is not provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mgetEffectiveModel[2m > [22mshould use default when neither explicit nor session is provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mgetEffectiveModel[2m > [22mshould use Claude default when no arguments provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mgetEffectiveModel[2m > [22mshould handle explicit empty strings as undefined[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mCLAUDE_MODEL_MAP[2m > [22mshould have haiku, sonnet, opus mappings[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mCLAUDE_MODEL_MAP[2m > [22mshould have valid Claude model strings[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mDEFAULT_MODELS[2m > [22mshould have claude default[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/model-resolver.test.ts[2m > [22mmodel-resolver.ts[2m > [22mDEFAULT_MODELS[2m > [22mshould have valid default model[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetScrollback[2m > [22m[2mshould return scrollback buffer for existing session
[22m[39m[Terminal] Creating session term-1766695791337-rxxxj35rh with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791337-rxxxj35rh created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetScrollback[2m > [22m[2mshould return scrollback buffer for existing session
[22m[39m[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetScrollback[2m > [22m[2mshould return null for non-existent session
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetAllSessions[2m > [22m[2mshould return all active sessions
[22m[39m[Terminal] Creating session term-1766695791338-92fmb9plu with shell: /bin/bash in /dir1
[Terminal] Session term-1766695791338-92fmb9plu created successfully
[Terminal] Creating session term-1766695791338-5fn4p97az with shell: /bin/bash in /dir2
[Terminal] Session term-1766695791338-5fn4p97az created successfully

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetAllSessions[2m > [22m[2mshould return all active sessions
[22m[39m[Terminal] Cleaning up 2 sessions

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mgetModelForUseCase[2m > [22m[2mshould return explicit model when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-sonnet-4-20250514

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetAllSessions[2m > [22m[2mshould return empty array if no sessions
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2monData and onExit[2m > [22m[2mshould allow subscribing and unsubscribing from data events
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mgetModelForUseCase[2m > [22m[2mshould use environment variable for spec model
[22m[39m[ModelResolver] Using full Claude model string: claude-sonnet-4-20250514

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2monData and onExit[2m > [22m[2mshould allow subscribing and unsubscribing from exit events
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcleanup[2m > [22m[2mshould clean up all sessions
[22m[39m[Terminal] Creating session term-1766695791340-yig51cgl5 with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791340-yig51cgl5 created successfully
[Terminal] Creating session term-1766695791340-v8muirm0d with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791340-v8muirm0d created successfully
[Terminal] Cleaning up 2 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcleanup[2m > [22m[2mshould clean up all sessions
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mgetModelForUseCase[2m > [22m[2mshould use default model for spec when no override
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcleanup[2m > [22m[2mshould handle cleanup errors gracefully
[22m[39m[Terminal] Creating session term-1766695791340-j8e8f6mey with shell: /bin/bash in /home/user
[Terminal] Session term-1766695791340-j8e8f6mey created successfully
[Terminal] Cleaning up 1 sessions

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mcleanup[2m > [22m[2mshould handle cleanup errors gracefully
[22m[39m[Terminal] Cleaning up 0 sessions

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mgetModelForUseCase[2m > [22m[2mshould fall back to AUTOMAKER_MODEL_DEFAULT
[22m[39m[ModelResolver] Using full Claude model string: claude-sonnet-4-20250514

[90mstdout[2m | tests/unit/services/terminal-service.test.ts[2m > [22m[2mterminal-service.ts[2m > [22m[2mgetTerminalService[2m > [22m[2mshould return singleton instance
[22m[39m[Terminal] Cleaning up 0 sessions

 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould detect PowerShell Core on Windows when available[32m 4[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould fall back to PowerShell on Windows if Core not available[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould fall back to cmd.exe on Windows if no PowerShell[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould detect user shell on macOS[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould fall back to zsh on macOS if user shell not available[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould fall back to bash on macOS if zsh not available[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould detect user shell on Linux[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould fall back to bash on Linux if user shell not available[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould fall back to sh on Linux if bash not available[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mdetectShell[2m > [22mshould detect WSL and use appropriate shell[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22misWSL[2m > [22mshould return true if /proc/version contains microsoft[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22misWSL[2m > [22mshould return true if /proc/version contains wsl[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22misWSL[2m > [22mshould return true if WSL_DISTRO_NAME is set[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22misWSL[2m > [22mshould return true if WSLENV is set[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22misWSL[2m > [22mshould return false if not in WSL[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22misWSL[2m > [22mshould return false if error reading /proc/version[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mgetPlatformInfo[2m > [22mshould return platform information[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcreateSession[2m > [22mshould create a new terminal session[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcreateSession[2m > [22mshould use default cols and rows if not provided[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcreateSession[2m > [22mshould fall back to home directory if cwd does not exist[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcreateSession[2m > [22mshould fall back to home directory if cwd is not a directory[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcreateSession[2m > [22mshould fix double slashes in path[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcreateSession[2m > [22mshould preserve WSL UNC paths[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcreateSession[2m > [22mshould handle data events from PTY[32m 5[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcreateSession[2m > [22mshould handle exit events from PTY[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mwrite[2m > [22mshould write data to existing session[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mwrite[2m > [22mshould return false for non-existent session[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mresize[2m > [22mshould resize existing session[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mresize[2m > [22mshould return false for non-existent session[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mresize[2m > [22mshould handle resize errors[32m 8[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mkillSession[2m > [22mshould kill existing session[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mkillSession[2m > [22mshould return false for non-existent session[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mkillSession[2m > [22mshould handle kill errors[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mgetSession[2m > [22mshould return existing session[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mgetSession[2m > [22mshould return undefined for non-existent session[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mgetScrollback[2m > [22mshould return scrollback buffer for existing session[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mgetScrollback[2m > [22mshould return null for non-existent session[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mgetAllSessions[2m > [22mshould return all active sessions[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mgetAllSessions[2m > [22mshould return empty array if no sessions[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22monData and onExit[2m > [22mshould allow subscribing and unsubscribing from data events[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22monData and onExit[2m > [22mshould allow subscribing and unsubscribing from exit events[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcleanup[2m > [22mshould clean up all sessions[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mcleanup[2m > [22mshould handle cleanup errors gracefully[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/terminal-service.test.ts[2m > [22mterminal-service.ts[2m > [22mgetTerminalService[2m > [22mshould return singleton instance[32m 1[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateSpecGenerationOptions[2m > [22m[2mshould create options with spec generation settings
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateSpecGenerationOptions[2m > [22m[2mshould include system prompt when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateSpecGenerationOptions[2m > [22m[2mshould include abort controller when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateFeatureGenerationOptions[2m > [22m[2mshould create options with feature generation settings
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateSuggestionsOptions[2m > [22m[2mshould create options with suggestions settings
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateSuggestionsOptions[2m > [22m[2mshould include systemPrompt when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateSuggestionsOptions[2m > [22m[2mshould include abortController when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateSuggestionsOptions[2m > [22m[2mshould include outputFormat when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateChatOptions[2m > [22m[2mshould create options with chat settings
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateChatOptions[2m > [22m[2mshould prefer explicit model over session model
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-20250514

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateChatOptions[2m > [22m[2mshould use session model when explicit model not provided
[22m[39m[ModelResolver] Using full Claude model string: claude-sonnet-4-20250514

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mgetDevServerService[2m > [22mshould return a singleton instance[32m 21[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstartDevServer[2m > [22mshould return error if worktree path does not exist[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstartDevServer[2m > [22mshould return error if no package.json found[32m 1[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateAutoModeOptions[2m > [22m[2mshould create options with auto mode settings
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101

 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAbortError[2m > [22mshould detect AbortError by error name[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAbortError[2m > [22mshould detect abort error by message content[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAbortError[2m > [22mshould return false for non-abort errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAbortError[2m > [22mshould return false for non-Error objects[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misCancellationError[2m > [22mshould detect 'cancelled' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misCancellationError[2m > [22mshould detect 'canceled' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misCancellationError[2m > [22mshould detect 'stopped' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misCancellationError[2m > [22mshould detect 'aborted' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misCancellationError[2m > [22mshould be case insensitive[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misCancellationError[2m > [22mshould return false for non-cancellation errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAuthenticationError[2m > [22mshould detect 'Authentication failed' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAuthenticationError[2m > [22mshould detect 'Invalid API key' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAuthenticationError[2m > [22mshould detect 'authentication_failed' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAuthenticationError[2m > [22mshould detect 'Fix external API key' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAuthenticationError[2m > [22mshould return false for non-authentication errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22misAuthenticationError[2m > [22mshould be case sensitive[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould classify authentication errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould classify abort errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould prioritize auth over abort if both match[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould classify cancellation errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould prioritize abort over cancellation if both match[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould classify cancellation errors with 'canceled' spelling[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould classify cancellation errors with 'stopped' message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould classify generic Error as execution error[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould classify non-Error objects as unknown[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mclassifyError[2m > [22mshould handle null and undefined[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mgetUserFriendlyErrorMessage[2m > [22mshould return friendly message for abort errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mgetUserFriendlyErrorMessage[2m > [22mshould return friendly message for authentication errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mgetUserFriendlyErrorMessage[2m > [22mshould return original message for other errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/error-handler.test.ts[2m > [22merror-handler.ts[2m > [22mgetUserFriendlyErrorMessage[2m > [22mshould handle non-Error objects[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/logger.test.ts[2m > [22mlogger.ts[2m > [22mLogLevel enum[2m > [22mshould have correct numeric values[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/logger.test.ts[2m > [22mlogger.ts[2m > [22msetLogLevel and getLogLevel[2m > [22mshould set and get log level[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/logger.test.ts[2m > [22mlogger.ts[2m > [22mcreateLogger[2m > [22mshould create a logger with context prefix[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/logger.test.ts[2m > [22mlogger.ts[2m > [22mcreateLogger[2m > [22mshould log error at all log levels[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/logger.test.ts[2m > [22mlogger.ts[2m > [22mcreateLogger[2m > [22mshould log warn when level is WARN or higher[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/logger.test.ts[2m > [22mlogger.ts[2m > [22mcreateLogger[2m > [22mshould log info when level is INFO or higher[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/logger.test.ts[2m > [22mlogger.ts[2m > [22mcreateLogger[2m > [22mshould log debug only when level is DEBUG[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/logger.test.ts[2m > [22mlogger.ts[2m > [22mcreateLogger[2m > [22mshould pass multiple arguments to log functions[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateAutoModeOptions[2m > [22m[2mshould include systemPrompt when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateAutoModeOptions[2m > [22m[2mshould include abortController when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101

 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22msanitizeBranchName[2m > [22mshould sanitize branch names with invalid characters[32m 7[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22msanitizeBranchName[2m > [22mshould sanitize branch names with Windows invalid characters[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22msanitizeBranchName[2m > [22mshould sanitize Windows reserved names[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22msanitizeBranchName[2m > [22mshould handle empty branch name[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22msanitizeBranchName[2m > [22mshould handle branch name that becomes empty after sanitization[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadWorktreeMetadata[2m > [22mshould return null when metadata file doesn't exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadWorktreeMetadata[2m > [22mshould read existing metadata[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadWorktreeMetadata[2m > [22mshould read metadata with PR info[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mwriteWorktreeMetadata[2m > [22mshould create metadata directory if it doesn't exist[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mwriteWorktreeMetadata[2m > [22mshould overwrite existing metadata[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mupdateWorktreePRInfo[2m > [22mshould create new metadata if it doesn't exist[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mupdateWorktreePRInfo[2m > [22mshould update existing metadata with PR info[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mupdateWorktreePRInfo[2m > [22mshould preserve existing metadata when updating PR info[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mgetWorktreePRInfo[2m > [22mshould return null when metadata doesn't exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mgetWorktreePRInfo[2m > [22mshould return null when metadata exists but has no PR info[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mgetWorktreePRInfo[2m > [22mshould return PR info when it exists[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadAllWorktreeMetadata[2m > [22mshould return empty map when worktrees directory doesn't exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadAllWorktreeMetadata[2m > [22mshould return empty map when worktrees directory is empty[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadAllWorktreeMetadata[2m > [22mshould read all worktree metadata[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadAllWorktreeMetadata[2m > [22mshould skip directories without worktree.json[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadAllWorktreeMetadata[2m > [22mshould skip files in worktrees directory[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mreadAllWorktreeMetadata[2m > [22mshould skip directories with malformed JSON[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mdeleteWorktreeMetadata[2m > [22mshould delete worktree metadata directory[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/worktree-metadata.test.ts[2m > [22mworktree-metadata.ts[2m > [22mdeleteWorktreeMetadata[2m > [22mshould handle deletion when metadata doesn't exist[32m 1[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateCustomOptions[2m > [22m[2mshould create options with custom settings
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101

 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould return plain text when no images provided[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould return plain text when imagePaths is empty array[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould build content blocks with single image[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould build content blocks with multiple images[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould include image paths in text when requested[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould not include image paths by default[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould handle empty text content[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould trim text content before checking if empty[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould return text when only one block and it's text[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/prompt-builder.test.ts[2m > [22mprompt-builder.ts[2m > [22mbuildPromptWithImages[2m > [22mshould pass workDir for path resolution[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateCustomOptions[2m > [22m[2mshould use defaults when optional params not provided
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateCustomOptions[2m > [22m[2mshould include sandbox when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateCustomOptions[2m > [22m[2mshould include systemPrompt when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101

[90mstdout[2m | tests/unit/lib/sdk-options.test.ts[2m > [22m[2msdk-options.ts[2m > [22m[2mcreateCustomOptions[2m > [22m[2mshould include abortController when provided
[22m[39m[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101

 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mTOOL_PRESETS[2m > [22mshould export readOnly tools[32m 119[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mTOOL_PRESETS[2m > [22mshould export specGeneration tools[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mTOOL_PRESETS[2m > [22mshould export fullAccess tools[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mTOOL_PRESETS[2m > [22mshould export chat tools matching fullAccess[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mMAX_TURNS[2m > [22mshould export turn presets[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mgetModelForUseCase[2m > [22mshould return explicit model when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mgetModelForUseCase[2m > [22mshould use environment variable for spec model[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mgetModelForUseCase[2m > [22mshould use default model for spec when no override[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mgetModelForUseCase[2m > [22mshould fall back to AUTOMAKER_MODEL_DEFAULT[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateSpecGenerationOptions[2m > [22mshould create options with spec generation settings[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateSpecGenerationOptions[2m > [22mshould include system prompt when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateSpecGenerationOptions[2m > [22mshould include abort controller when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateFeatureGenerationOptions[2m > [22mshould create options with feature generation settings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateSuggestionsOptions[2m > [22mshould create options with suggestions settings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateSuggestionsOptions[2m > [22mshould include systemPrompt when provided[32m 3[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateSuggestionsOptions[2m > [22mshould include abortController when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateSuggestionsOptions[2m > [22mshould include outputFormat when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateChatOptions[2m > [22mshould create options with chat settings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateChatOptions[2m > [22mshould prefer explicit model over session model[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateChatOptions[2m > [22mshould use session model when explicit model not provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateAutoModeOptions[2m > [22mshould create options with auto mode settings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateAutoModeOptions[2m > [22mshould include systemPrompt when provided[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateAutoModeOptions[2m > [22mshould include abortController when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateCustomOptions[2m > [22mshould create options with custom settings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateCustomOptions[2m > [22mshould use defaults when optional params not provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateCustomOptions[2m > [22mshould include sandbox when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateCustomOptions[2m > [22mshould include systemPrompt when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/sdk-options.test.ts[2m > [22msdk-options.ts[2m > [22mcreateCustomOptions[2m > [22mshould include abortController when provided[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mmkdirSafe[2m > [22mshould create a new directory[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mmkdirSafe[2m > [22mshould succeed if directory already exists[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mmkdirSafe[2m > [22mshould create nested directories[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mmkdirSafe[2m > [22mshould throw if path exists as a file[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mmkdirSafe[2m > [22mshould succeed if path is a symlink to a directory[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mmkdirSafe[2m > [22mshould handle ELOOP error gracefully when checking path[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mmkdirSafe[2m > [22mshould handle EEXIST error gracefully when creating directory[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mmkdirSafe[2m > [22mshould handle ELOOP error gracefully when creating directory[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mexistsSafe[2m > [22mshould return true for existing file[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mexistsSafe[2m > [22mshould return true for existing directory[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mexistsSafe[2m > [22mshould return false for non-existent path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mexistsSafe[2m > [22mshould return true for symlink[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mexistsSafe[2m > [22mshould return true for broken symlink (symlink exists even if target doesn't)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mexistsSafe[2m > [22mshould return true for ELOOP error (symlink loop)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/fs-utils.test.ts[2m > [22mfs-utils.ts[2m > [22mexistsSafe[2m > [22mshould throw for other errors[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mextractTextFromContent[2m > [22mshould return string content as-is[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mextractTextFromContent[2m > [22mshould extract text from single text block[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mextractTextFromContent[2m > [22mshould extract and join multiple text blocks with newlines[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mextractTextFromContent[2m > [22mshould ignore non-text blocks[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mextractTextFromContent[2m > [22mshould handle blocks without text property[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mextractTextFromContent[2m > [22mshould handle empty array[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mextractTextFromContent[2m > [22mshould handle array with only non-text blocks[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mnormalizeContentBlocks[2m > [22mshould convert string to content block array[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mnormalizeContentBlocks[2m > [22mshould return array content as-is[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mnormalizeContentBlocks[2m > [22mshould handle empty string[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mformatHistoryAsText[2m > [22mshould return empty string for empty history[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mformatHistoryAsText[2m > [22mshould format single user message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mformatHistoryAsText[2m > [22mshould format single assistant message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mformatHistoryAsText[2m > [22mshould format multiple messages with correct roles[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mformatHistoryAsText[2m > [22mshould handle messages with array content (multipart)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mformatHistoryAsText[2m > [22mshould format all messages from fixture[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mformatHistoryAsText[2m > [22mshould separate messages with double newlines[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mconvertHistoryToMessages[2m > [22mshould convert empty history[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mconvertHistoryToMessages[2m > [22mshould convert single message to SDK format[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mconvertHistoryToMessages[2m > [22mshould normalize string content to array[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mconvertHistoryToMessages[2m > [22mshould preserve array content[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mconvertHistoryToMessages[2m > [22mshould convert multiple messages[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mconvertHistoryToMessages[2m > [22mshould set correct fields for SDK format[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/conversation-utils.test.ts[2m > [22mconversation-utils.ts[2m > [22mconvertHistoryToMessages[2m > [22mshould handle all messages from fixture[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/feature-loader.test.ts[2m > [22m[2mfeature-loader.ts[2m > [22m[2mcreate[2m > [22m[2mshould create new feature
[22m[39m[FeatureLoader] Created feature feature-1766695791368-fiu2tcwhd

[90mstdout[2m | tests/unit/services/feature-loader.test.ts[2m > [22m[2mfeature-loader.ts[2m > [22m[2mcreate[2m > [22m[2mshould use provided ID if given
[22m[39m[FeatureLoader] Created feature custom-id

[90mstdout[2m | tests/unit/services/feature-loader.test.ts[2m > [22m[2mfeature-loader.ts[2m > [22m[2mcreate[2m > [22m[2mshould set default category if not provided
[22m[39m[FeatureLoader] Created feature feature-1766695791369-612qn4l59

 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTaskLine[2m > [22mshould parse task with file path[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTaskLine[2m > [22mshould parse task without file path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTaskLine[2m > [22mshould include phase when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTaskLine[2m > [22mshould return null for invalid line[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTaskLine[2m > [22mshould handle multi-word descriptions[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTaskLine[2m > [22mshould trim whitespace from description and file path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTasksFromSpec[2m > [22mshould parse tasks from a tasks code block[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTasksFromSpec[2m > [22mshould parse tasks with phases[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTasksFromSpec[2m > [22mshould return empty array for content without tasks[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTasksFromSpec[2m > [22mshould fallback to finding task lines outside code block[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTasksFromSpec[2m > [22mshould handle empty tasks block[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTasksFromSpec[2m > [22mshould handle mixed valid and invalid lines[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTasksFromSpec[2m > [22mshould preserve task order[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mparseTasksFromSpec[2m > [22mshould handle task IDs with different numbers[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mspec content generation patterns[2m > [22mshould match the expected lite mode output format[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mspec content generation patterns[2m > [22mshould match the expected spec mode output format[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-task-parsing.test.ts[2m > [22mTask Parsing[2m > [22mspec content generation patterns[2m > [22mshould match the expected full mode output format[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/feature-loader.test.ts[2m > [22m[2mfeature-loader.ts[2m > [22m[2mupdate[2m > [22m[2mshould update existing feature
[22m[39m[FeatureLoader] Updated feature feature-123

[90mstdout[2m | tests/unit/services/feature-loader.test.ts[2m > [22m[2mfeature-loader.ts[2m > [22m[2mdelete[2m > [22m[2mshould delete feature directory
[22m[39m[FeatureLoader] Deleted feature feature-123

 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mspecToXml[2m > [22mshould convert minimal spec to XML[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mspecToXml[2m > [22mshould escape XML special characters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mspecToXml[2m > [22mshould include file_locations when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mspecToXml[2m > [22mshould not include file_locations when empty[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mspecToXml[2m > [22mshould include additional_requirements when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mspecToXml[2m > [22mshould include development_guidelines when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mspecToXml[2m > [22mshould include implementation_roadmap when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mspecToXml[2m > [22mshould not include optional sections when empty[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mgetStructuredSpecPromptInstruction[2m > [22mshould return non-empty prompt instruction[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mgetStructuredSpecPromptInstruction[2m > [22mshould mention required fields[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mgetAppSpecFormatInstruction[2m > [22mshould return non-empty format instruction[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mgetAppSpecFormatInstruction[2m > [22mshould include critical formatting requirements[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/app-spec-format.test.ts[2m > [22mapp-spec-format.ts[2m > [22mAPP_SPEC_XML_FORMAT[2m > [22mshould contain valid XML template structure[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/auto-mode-service-planning.test.ts[2m > [22m[2mauto-mode-service.ts - Planning Mode[2m > [22m[2mplan approval flow[2m > [22m[2mshould allow cancelling non-existent approval without error
[22m[39m[AutoMode] cancelPlanApproval called for feature non-existent
[AutoMode] Current pending approvals: none
[AutoMode] No pending approval to cancel for feature non-existent

[90mstdout[2m | tests/unit/services/auto-mode-service-planning.test.ts[2m > [22m[2mauto-mode-service.ts - Planning Mode[2m > [22m[2mresolvePlanApproval[2m > [22m[2mshould return error when no pending approval exists
[22m[39m[AutoMode] resolvePlanApproval called for feature non-existent-feature, approved=true
[AutoMode] Current pending approvals: none
[AutoMode] No pending approval in Map for feature non-existent-feature
[AutoMode] ERROR: No pending approval found for feature non-existent-feature and recovery not possible

[90mstdout[2m | tests/unit/services/auto-mode-service-planning.test.ts[2m > [22m[2mauto-mode-service.ts - Planning Mode[2m > [22m[2mresolvePlanApproval[2m > [22m[2mshould handle approval with edited plan
[22m[39m[AutoMode] resolvePlanApproval called for feature test-feature, approved=true
[AutoMode] Current pending approvals: none
[AutoMode] No pending approval in Map for feature test-feature
[AutoMode] ERROR: No pending approval found for feature test-feature and recovery not possible

[90mstdout[2m | tests/unit/services/auto-mode-service-planning.test.ts[2m > [22m[2mauto-mode-service.ts - Planning Mode[2m > [22m[2mresolvePlanApproval[2m > [22m[2mshould handle rejection with feedback
[22m[39m[AutoMode] resolvePlanApproval called for feature test-feature, approved=false
[AutoMode] Current pending approvals: none
[AutoMode] No pending approval in Map for feature test-feature
[AutoMode] ERROR: No pending approval found for feature test-feature and recovery not possible

 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mgetMimeTypeForImage[2m > [22mshould return correct MIME type for .jpg[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mgetMimeTypeForImage[2m > [22mshould return correct MIME type for .jpeg[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mgetMimeTypeForImage[2m > [22mshould return correct MIME type for .png[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mgetMimeTypeForImage[2m > [22mshould return correct MIME type for .gif[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mgetMimeTypeForImage[2m > [22mshould return correct MIME type for .webp[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mgetMimeTypeForImage[2m > [22mshould be case-insensitive[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mgetMimeTypeForImage[2m > [22mshould default to image/png for unknown extensions[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mgetMimeTypeForImage[2m > [22mshould handle paths with multiple dots[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mreadImageAsBase64[2m > [22mshould read image and return base64 data[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mreadImageAsBase64[2m > [22mshould handle different image formats[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mreadImageAsBase64[2m > [22mshould extract filename from path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mreadImageAsBase64[2m > [22mshould throw error if file cannot be read[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mconvertImagesToContentBlocks[2m > [22mshould convert single image to content block[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mconvertImagesToContentBlocks[2m > [22mshould convert multiple images to content blocks[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mconvertImagesToContentBlocks[2m > [22mshould resolve relative paths with workDir[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mconvertImagesToContentBlocks[2m > [22mshould handle absolute paths without workDir[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mconvertImagesToContentBlocks[2m > [22mshould continue processing on individual image errors[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mconvertImagesToContentBlocks[2m > [22mshould return empty array for empty input[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mconvertImagesToContentBlocks[2m > [22mshould handle undefined workDir[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mformatImagePathsForPrompt[2m > [22mshould format single image path as bulleted list[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mformatImagePathsForPrompt[2m > [22mshould format multiple image paths as bulleted list[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mformatImagePathsForPrompt[2m > [22mshould return empty string for empty array[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mformatImagePathsForPrompt[2m > [22mshould start with double newline[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/lib/image-handler.test.ts[2m > [22mimage-handler.ts[2m > [22mformatImagePathsForPrompt[2m > [22mshould handle paths with special characters[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateGlobalSettings[2m > [22m[2mshould create settings file with updates
[22m[39m[SettingsService] Global settings updated

 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetFeaturesDir[2m > [22mshould return features directory path[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetFeatureImagesDir[2m > [22mshould return feature images directory path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetFeatureDir[2m > [22mshould return feature directory path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetFeatureJsonPath[2m > [22mshould return feature.json path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAgentOutputPath[2m > [22mshould return agent-output.md path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgenerateFeatureId[2m > [22mshould generate unique feature ID with timestamp[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgenerateFeatureId[2m > [22mshould start with 'feature-'[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAll[2m > [22mshould return empty array when features directory doesn't exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAll[2m > [22mshould load all features from feature directories[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAll[2m > [22mshould skip features without id field[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAll[2m > [22mshould skip features with missing feature.json[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAll[2m > [22mshould handle malformed JSON gracefully[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAll[2m > [22mshould sort features by creation order (timestamp)[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mget[2m > [22mshould return feature by ID[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mget[2m > [22mshould return null when feature doesn't exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mget[2m > [22mshould throw on other errors[32m 4[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mcreate[2m > [22mshould create new feature[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mcreate[2m > [22mshould use provided ID if given[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mcreate[2m > [22mshould set default category if not provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mupdate[2m > [22mshould update existing feature[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mupdate[2m > [22mshould throw if feature doesn't exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mdelete[2m > [22mshould delete feature directory[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mdelete[2m > [22mshould return false on error[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAgentOutput[2m > [22mshould return agent output content[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAgentOutput[2m > [22mshould return null when file doesn't exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mgetAgentOutput[2m > [22mshould throw on other errors[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22msaveAgentOutput[2m > [22mshould save agent output to file[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mdeleteAgentOutput[2m > [22mshould delete agent output file[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mdeleteAgentOutput[2m > [22mshould handle missing file gracefully[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/feature-loader.test.ts[2m > [22mfeature-loader.ts[2m > [22mdeleteAgentOutput[2m > [22mshould throw on other errors[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mgetPlanningPromptPrefix[2m > [22mshould return empty string for skip mode[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mgetPlanningPromptPrefix[2m > [22mshould return empty string when planningMode is undefined[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mgetPlanningPromptPrefix[2m > [22mshould return lite prompt for lite mode without approval[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mgetPlanningPromptPrefix[2m > [22mshould return lite_with_approval prompt for lite mode with approval[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mgetPlanningPromptPrefix[2m > [22mshould return spec prompt for spec mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mgetPlanningPromptPrefix[2m > [22mshould return full prompt for full mode[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mgetPlanningPromptPrefix[2m > [22mshould include the separator and Feature Request header[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mgetPlanningPromptPrefix[2m > [22mshould instruct agent to NOT output exploration text[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mparseTasksFromSpec (via module)[2m > [22mshould parse tasks from a valid tasks block[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mparseTasksFromSpec (via module)[2m > [22mshould handle tasks block with phases[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mplan approval flow[2m > [22mshould track pending approvals correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mplan approval flow[2m > [22mshould allow cancelling non-existent approval without error[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mplan approval flow[2m > [22mshould return running features count after stop[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mresolvePlanApproval[2m > [22mshould return error when no pending approval exists[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mresolvePlanApproval[2m > [22mshould handle approval with edited plan[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mresolvePlanApproval[2m > [22mshould handle rejection with feedback[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mbuildFeaturePrompt[2m > [22mshould include feature ID and description[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mbuildFeaturePrompt[2m > [22mshould include specification when present[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mbuildFeaturePrompt[2m > [22mshould include image paths when present[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mbuildFeaturePrompt[2m > [22mshould include summary tags instruction[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mextractTitleFromDescription[2m > [22mshould return 'Untitled Feature' for empty description[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mextractTitleFromDescription[2m > [22mshould return first line if under 60 characters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mextractTitleFromDescription[2m > [22mshould truncate long first lines to 60 characters[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mPLANNING_PROMPTS structure[2m > [22mshould have all required planning modes[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mPLANNING_PROMPTS structure[2m > [22mlite prompt should include correct structure[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mPLANNING_PROMPTS structure[2m > [22mspec prompt should include task format instructions[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mPLANNING_PROMPTS structure[2m > [22mfull prompt should include phases[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service-planning.test.ts[2m > [22mauto-mode-service.ts - Planning Mode[2m > [22mstatus management[2m > [22mshould report correct status[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateGlobalSettings[2m > [22m[2mshould merge updates with existing settings
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateGlobalSettings[2m > [22m[2mshould deep merge keyboard shortcuts
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateGlobalSettings[2m > [22m[2mshould create data directory if it does not exist
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mhasGlobalSettings[2m > [22m[2mshould return true when settings file exists
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateCredentials[2m > [22m[2mshould create credentials file with updates
[22m[39m[SettingsService] Credentials updated

 [32mâœ“[39m tests/unit/services/auto-mode-service.test.ts[2m > [22mauto-mode-service.ts[2m > [22mconstructor[2m > [22mshould initialize with event emitter[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service.test.ts[2m > [22mauto-mode-service.ts[2m > [22mstartAutoLoop[2m > [22mshould throw if auto mode is already running[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service.test.ts[2m > [22mauto-mode-service.ts[2m > [22mstartAutoLoop[2m > [22mshould emit auto mode start event[32m 11[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service.test.ts[2m > [22mauto-mode-service.ts[2m > [22mstopAutoLoop[2m > [22mshould stop the auto loop[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/auto-mode-service.test.ts[2m > [22mauto-mode-service.ts[2m > [22mstopAutoLoop[2m > [22mshould return 0 when not running[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateCredentials[2m > [22m[2mshould merge updates with existing credentials
[22m[39m[SettingsService] Credentials updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateCredentials[2m > [22m[2mshould deep merge api keys
[22m[39m[SettingsService] Credentials updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mgetMaskedCredentials[2m > [22m[2mshould mask keys correctly
[22m[39m[SettingsService] Credentials updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mgetMaskedCredentials[2m > [22m[2mshould handle short keys
[22m[39m[SettingsService] Credentials updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mhasCredentials[2m > [22m[2mshould return true when credentials file exists
[22m[39m[SettingsService] Credentials updated

 [32mâœ“[39m tests/unit/services/beads-service.test.ts[2m > [22mBeadsService[2m > [22mgetDatabasePath[2m > [22mshould return correct database path[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/beads-service.test.ts[2m > [22mBeadsService[2m > [22mgetDatabasePath[2m > [22mshould handle paths with trailing slash[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/beads-service.test.ts[2m > [22mBeadsService[2m > [22misNotInitializedError[2m > [22mshould detect database not found error[32m 0[2mms[22m[39m
[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateProjectSettings[2m > [22m[2mshould create project settings file with updates
[22m[39m[SettingsService] Project settings updated for /tmp/claude/project-test-1766695791389

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateProjectSettings[2m > [22m[2mshould merge updates with existing project settings
[22m[39m[SettingsService] Project settings updated for /tmp/claude/project-test-1766695791390

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateProjectSettings[2m > [22m[2mshould deep merge board background
[22m[39m[SettingsService] Project settings updated for /tmp/claude/project-test-1766695791391

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mupdateProjectSettings[2m > [22m[2mshould create .automaker directory if it does not exist
[22m[39m[SettingsService] Project settings updated for /tmp/claude/new-project-1766695791393

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mhasProjectSettings[2m > [22m[2mshould return true when project settings file exists
[22m[39m[SettingsService] Project settings updated for /tmp/claude/project-test-1766695791394

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate global settings from localStorage data
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate global settings from localStorage data
[22m[39m[SettingsService] Migrated global settings from localStorage
[SettingsService] Migration complete: 0 projects migrated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate credentials from localStorage data
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate credentials from localStorage data
[22m[39m[SettingsService] Migrated global settings from localStorage

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate credentials from localStorage data
[22m[39m[SettingsService] Credentials updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate credentials from localStorage data
[22m[39m[SettingsService] Migrated credentials from localStorage
[SettingsService] Migration complete: 0 projects migrated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate project settings from localStorage data
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate project settings from localStorage data
[22m[39m[SettingsService] Migrated global settings from localStorage

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate project settings from localStorage data
[22m[39m[SettingsService] Project settings updated for /tmp/claude/project-test-1766695791396

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould migrate project settings from localStorage data
[22m[39m[SettingsService] Migration complete: 1 projects migrated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould handle direct localStorage values
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould handle direct localStorage values
[22m[39m[SettingsService] Migrated global settings from localStorage
[SettingsService] Migration complete: 0 projects migrated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould handle invalid JSON gracefully
[22m[39m[SettingsService] Global settings updated

[90mstdout[2m | tests/unit/services/settings-service.test.ts[2m > [22m[2msettings-service.ts[2m > [22m[2mmigrateFromLocalStorage[2m > [22m[2mshould handle invalid JSON gracefully
[22m[39m[SettingsService] Migrated global settings from localStorage
[SettingsService] Migration complete: 0 projects migrated

 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22msetRunningState[2m > [22mshould set isRunning to true when running is true[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22msetRunningState[2m > [22mshould set isRunning to false when running is false[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22msetRunningState[2m > [22mshould set currentAbortController when provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22msetRunningState[2m > [22mshould set currentAbortController to null when not provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22msetRunningState[2m > [22mshould set currentAbortController to null when explicitly passed null[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22msetRunningState[2m > [22mshould update state multiple times correctly[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22mgetErrorMessage[2m > [22mshould return message from Error instance[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22mgetErrorMessage[2m > [22mshould return 'Unknown error' for non-Error objects[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22mgetErrorMessage[2m > [22mshould return message from Error with empty message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22mgetErrorMessage[2m > [22mshould handle Error objects with custom properties[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/routes/app-spec/common.test.ts[2m > [22mapp-spec/common.ts[2m > [22mgetErrorMessage[2m > [22mshould handle Error objects created with different constructors[32m 0[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mworktree operations[2m > [22m[2mshould use existing git worktree for feature
[22m[39m[AutoMode] Using worktree for branch "feature/test-feature-1": /tmp/claude/automaker-test-EpJiL5/.worktrees/test-feature-1

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mworktree operations[2m > [22m[2mshould use existing git worktree for feature
[22m[39m[AutoMode] Executing feature test-feature-1 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-EpJiL5/.worktrees/test-feature-1
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature test-feature-1 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetGlobalSettings[2m > [22mshould return default settings when file does not exist[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetGlobalSettings[2m > [22mshould read and return existing settings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetGlobalSettings[2m > [22mshould merge with defaults for missing properties[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetGlobalSettings[2m > [22mshould merge keyboard shortcuts deeply[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateGlobalSettings[2m > [22mshould create settings file with updates[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateGlobalSettings[2m > [22mshould merge updates with existing settings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateGlobalSettings[2m > [22mshould deep merge keyboard shortcuts[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateGlobalSettings[2m > [22mshould create data directory if it does not exist[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mhasGlobalSettings[2m > [22mshould return false when settings file does not exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mhasGlobalSettings[2m > [22mshould return true when settings file exists[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetCredentials[2m > [22mshould return default credentials when file does not exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetCredentials[2m > [22mshould read and return existing credentials[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetCredentials[2m > [22mshould merge with defaults for missing api keys[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateCredentials[2m > [22mshould create credentials file with updates[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateCredentials[2m > [22mshould merge updates with existing credentials[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateCredentials[2m > [22mshould deep merge api keys[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetMaskedCredentials[2m > [22mshould return masked credentials for empty keys[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetMaskedCredentials[2m > [22mshould mask keys correctly[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetMaskedCredentials[2m > [22mshould handle short keys[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mhasCredentials[2m > [22mshould return false when credentials file does not exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mhasCredentials[2m > [22mshould return true when credentials file exists[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetProjectSettings[2m > [22mshould return default settings when file does not exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetProjectSettings[2m > [22mshould read and return existing project settings[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetProjectSettings[2m > [22mshould merge with defaults for missing properties[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateProjectSettings[2m > [22mshould create project settings file with updates[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateProjectSettings[2m > [22mshould merge updates with existing project settings[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateProjectSettings[2m > [22mshould deep merge board background[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mupdateProjectSettings[2m > [22mshould create .automaker directory if it does not exist[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mhasProjectSettings[2m > [22mshould return false when project settings file does not exist[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mhasProjectSettings[2m > [22mshould return true when project settings file exists[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mmigrateFromLocalStorage[2m > [22mshould migrate global settings from localStorage data[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mmigrateFromLocalStorage[2m > [22mshould migrate credentials from localStorage data[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mmigrateFromLocalStorage[2m > [22mshould migrate project settings from localStorage data[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mmigrateFromLocalStorage[2m > [22mshould handle direct localStorage values[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mmigrateFromLocalStorage[2m > [22mshould handle invalid JSON gracefully[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mmigrateFromLocalStorage[2m > [22mshould handle migration errors gracefully[32m 4[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22mgetDataDir[2m > [22mshould return the data directory path[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/settings-service.test.ts[2m > [22msettings-service.ts[2m > [22matomicWriteJson[2m > [22mshould handle write errors and clean up temp file[32m 1[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mworktree operations[2m > [22m[2mshould use existing git worktree for feature
[22m[39m[AutoMode] Feature test-feature-1 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/unit/services/agent-service.test.ts[2m > [22m[2magent-service.ts[2m > [22m[2msendMessage[2m > [22m[2mshould process message and stream responses
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001
[AgentService] Using provider "claude" for model "claude-haiku-4-5-20251001"

[90mstdout[2m | tests/unit/services/agent-service.test.ts[2m > [22m[2magent-service.ts[2m > [22m[2msendMessage[2m > [22m[2mshould handle images in message
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001
[AgentService] Using provider "claude" for model "claude-haiku-4-5-20251001"

[90mstdout[2m | tests/unit/services/agent-service.test.ts[2m > [22m[2magent-service.ts[2m > [22m[2msendMessage[2m > [22m[2mshould handle failed image loading gracefully
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001
[AgentService] Using provider "claude" for model "claude-haiku-4-5-20251001"

[90mstdout[2m | tests/unit/services/agent-service.test.ts[2m > [22m[2magent-service.ts[2m > [22m[2msendMessage[2m > [22m[2mshould use custom model if provided
[22m[39m[ModelResolver] Using full Claude model string: claude-sonnet-4-20250514
[AgentService] Using provider "claude" for model "claude-sonnet-4-20250514"

[90mstdout[2m | tests/unit/services/agent-service.test.ts[2m > [22m[2magent-service.ts[2m > [22m[2msendMessage[2m > [22m[2mshould save session messages
[22m[39m[ModelResolver] Using full Claude model string: claude-haiku-4-5-20251001
[AgentService] Using provider "claude" for model "claude-haiku-4-5-20251001"

[90mstdout[2m | tests/integration/routes/worktree/create.integration.test.ts[2m > [22m[2mworktree create route - repositories without commits[2m > [22m[2mcreates an initial commit before adding a worktree when HEAD is missing
[22m[39m[Worktree] [Worktree] Created initial empty commit to enable worktrees in /tmp/claude/automaker-no-commit-m7hcmA

 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22minitialize[2m > [22mshould create state directory[32m 2[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22mstartConversation[2m > [22mshould create new session with empty messages[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22mstartConversation[2m > [22mshould load existing session[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22mstartConversation[2m > [22mshould use process.cwd() if no working directory provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22mstartConversation[2m > [22mshould reuse existing session if already started[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22msendMessage[2m > [22mshould throw if session not found[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22msendMessage[2m > [22mshould process message and stream responses[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22msendMessage[2m > [22mshould handle images in message[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22msendMessage[2m > [22mshould handle failed image loading gracefully[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22msendMessage[2m > [22mshould use custom model if provided[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22msendMessage[2m > [22mshould save session messages[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22mstopExecution[2m > [22mshould stop execution for a session[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22mgetHistory[2m > [22mshould return message history[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22mgetHistory[2m > [22mshould handle non-existent session[32m 0[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/agent-service.test.ts[2m > [22magent-service.ts[2m > [22mclearSession[2m > [22mshould clear session messages[32m 0[2mms[22m[39m
[90mstdout[2m | tests/integration/routes/worktree/create.integration.test.ts[2m > [22m[2mworktree create route - repositories without commits[2m > [22m[2mcreates an initial commit before adding a worktree when HEAD is missing
[22m[39m[branch-tracking] Now tracking branch: feature/no-head

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mworktree operations[2m > [22m[2mshould handle error gracefully
[22m[39m[AutoMode] Executing feature test-feature-error with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-FuGskU
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature test-feature-error with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

 [32mâœ“[39m tests/integration/routes/worktree/create.integration.test.ts[2m > [22mworktree create route - repositories without commits[2m > [22mcreates an initial commit before adding a worktree when HEAD is missing[32m 33[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mworktree operations[2m > [22m[2mshould handle error gracefully
[22m[39m[AutoMode] Feature test-feature-error execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mworktree operations[2m > [22m[2mshould work without worktrees
[22m[39m[AutoMode] Executing feature test-no-worktree with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-dalJpy
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature test-no-worktree with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mworktree operations[2m > [22m[2mshould work without worktrees
[22m[39m[AutoMode] Feature test-no-worktree execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mfeature execution[2m > [22m[2mshould execute feature and update status
[22m[39m[AutoMode] Executing feature feature-exec-1 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-nLjoNN
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature feature-exec-1 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mfeature execution[2m > [22m[2mshould execute feature and update status
[22m[39m[AutoMode] Feature feature-exec-1 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mworktree operations[2m > [22mshould use existing git worktree for feature[32m 40[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mworktree operations[2m > [22mshould handle error gracefully[32m 21[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mworktree operations[2m > [22mshould work without worktrees[32m 16[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mfeature execution[2m > [22mshould execute feature and update status[32m 17[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mfeature execution[2m > [22m[2mshould handle feature not found
[22m[39m[AutoMode] Feature nonexistent-feature execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstartDevServer[2m > [22m[2mshould detect npm as package manager with package-lock.json
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695791280
[DevServerService] Command: npm run dev with PORT=3001

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mfeature execution[2m > [22m[2mshould prevent duplicate feature execution
[22m[39m[AutoMode] Executing feature feature-dup with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-v9ToUS
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature feature-dup with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mfeature execution[2m > [22mshould handle feature not found[32m 16[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mfeature execution[2m > [22m[2mshould prevent duplicate feature execution
[22m[39m[AutoMode] Feature feature-dup execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mfeature execution[2m > [22m[2mshould use feature-specific model
[22m[39m[ModelResolver] Using full Claude model string: claude-sonnet-4-20250514
[AutoMode] Executing feature feature-model with model: claude-sonnet-4-20250514 in /tmp/claude/automaker-test-iX715L
[ModelResolver] Using full Claude model string: claude-sonnet-4-20250514
[AutoMode] runAgent called for feature feature-model with model: claude-sonnet-4-20250514, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-sonnet-4-20250514"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mfeature execution[2m > [22m[2mshould use feature-specific model
[22m[39m[AutoMode] Feature feature-model execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstartDevServer[2m > [22mshould detect npm as package manager with package-lock.json[33m 704[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mfeature execution[2m > [22mshould prevent duplicate feature execution[33m 518[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mfeature execution[2m > [22mshould use feature-specific model[32m 15[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mauto loop[2m > [22m[2mshould process pending features in auto loop
[22m[39m[AutoMode] Executing feature auto-1 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-ZDqVnl
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature auto-1 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mauto loop[2m > [22m[2mshould process pending features in auto loop
[22m[39m[AutoMode] Feature auto-1 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstartDevServer[2m > [22m[2mshould detect yarn as package manager with yarn.lock
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695791984
[DevServerService] Command: yarn dev with PORT=3001

 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mauto loop[2m > [22mshould start and stop auto loop[32m 117[2mms[22m[39m
[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstartDevServer[2m > [22m[2mshould detect pnpm as package manager with pnpm-lock.yaml
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695792686
[DevServerService] Command: pnpm run dev with PORT=3001

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstartDevServer[2m > [22mshould detect yarn as package manager with yarn.lock[33m 702[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstartDevServer[2m > [22mshould detect pnpm as package manager with pnpm-lock.yaml[33m 703[2mms[22m[39m
[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstartDevServer[2m > [22m[2mshould detect bun as package manager with bun.lockb
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695793390
[DevServerService] Command: bun run dev with PORT=3001

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mauto loop[2m > [22m[2mshould process pending features in auto loop
[22m[39m[AutoMode] Executing feature auto-2 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-ZDqVnl
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature auto-2 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mauto loop[2m > [22m[2mshould process pending features in auto loop
[22m[39m[AutoMode] Feature auto-2 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstartDevServer[2m > [22mshould detect bun as package manager with bun.lockb[33m 704[2mms[22m[39m
[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstartDevServer[2m > [22m[2mshould return existing server info if already running
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695794094
[DevServerService] Command: bun run dev with PORT=3001

[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstartDevServer[2m > [22m[2mshould start dev server successfully
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695794798
[DevServerService] Command: bun run dev with PORT=3001

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mauto loop[2m > [22m[2mshould respect max concurrency
[22m[39m[AutoMode] Executing feature concurrent-1 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-2P3xJ6
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature concurrent-1 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mauto loop[2m > [22mshould process pending features in auto loop[33m 3020[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstartDevServer[2m > [22mshould return existing server info if already running[33m 705[2mms[22m[39m
[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstopDevServer[2m > [22m[2mshould return success if server not found
[22m[39m[DevServerService] No server record for /nonexistent/path, may have already stopped

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstartDevServer[2m > [22mshould start dev server successfully[33m 704[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstopDevServer[2m > [22mshould return success if server not found[32m 1[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mauto loop[2m > [22m[2mshould respect max concurrency
[22m[39m[AutoMode] Feature concurrent-1 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstopDevServer[2m > [22m[2mshould stop a running server
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695795504
[DevServerService] Command: bun run dev with PORT=3001

[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstopDevServer[2m > [22m[2mshould stop a running server
[22m[39m[DevServerService] Stopping dev server for /tmp/claude/dev-server-test-1766695795504

[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mlistDevServers[2m > [22m[2mshould list running servers
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695796208
[DevServerService] Command: bun run dev with PORT=3001

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstopDevServer[2m > [22mshould stop a running server[33m 703[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mlistDevServers[2m > [22mshould return empty list when no servers running[32m 1[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mlistDevServers[2m > [22mshould list running servers[33m 703[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22misRunning[2m > [22mshould return false for non-running server[32m 1[2mms[22m[39m
[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2misRunning[2m > [22m[2mshould return true for running server
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695796913
[DevServerService] Command: bun run dev with PORT=3001

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mauto loop[2m > [22m[2mshould respect max concurrency
[22m[39m[AutoMode] Executing feature concurrent-2 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-2P3xJ6
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature concurrent-2 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mauto loop[2m > [22m[2mshould respect max concurrency
[22m[39m[AutoMode] Feature concurrent-2 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22misRunning[2m > [22mshould return true for running server[33m 702[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mgetServerInfo[2m > [22mshould return undefined for non-running server[32m 1[2mms[22m[39m
[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mgetServerInfo[2m > [22m[2mshould return info for running server
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695797616
[DevServerService] Command: bun run dev with PORT=3001

 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mauto loop[2m > [22mshould respect max concurrency[33m 3019[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2merror handling[2m > [22m[2mshould handle provider errors gracefully
[22m[39m[AutoMode] Executing feature error-feature with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-wHGiDZ
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature error-feature with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2merror handling[2m > [22m[2mshould handle provider errors gracefully
[22m[39m[AutoMode] Feature error-feature execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2merror handling[2m > [22m[2mshould continue auto loop after feature error
[22m[39m[AutoMode] Executing feature fail-1 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-QVjOPe
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature fail-1 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2merror handling[2m > [22m[2mshould continue auto loop after feature error
[22m[39m[AutoMode] Feature fail-1 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mauto loop[2m > [22mshould emit auto mode events[32m 117[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22merror handling[2m > [22mshould handle provider errors gracefully[32m 16[2mms[22m[39m
 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mgetServerInfo[2m > [22mshould return info for running server[33m 702[2mms[22m[39m
[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mgetAllocatedPorts[2m > [22m[2mshould return allocated ports
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695798318
[DevServerService] Command: bun run dev with PORT=3001

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mgetAllocatedPorts[2m > [22mshould return allocated ports[33m 702[2mms[22m[39m
[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstopAll[2m > [22m[2mshould stop all running servers
[22m[39m[DevServerService] Starting dev server on port 3001
[DevServerService] Working directory (cwd): /tmp/claude/dev-server-test-1766695799020
[DevServerService] Command: bun run dev with PORT=3001

[90mstdout[2m | tests/unit/services/dev-server-service.test.ts[2m > [22m[2mdev-server-service.ts[2m > [22m[2mstopAll[2m > [22m[2mshould stop all running servers
[22m[39m[DevServerService] Stopping all 1 dev servers
[DevServerService] Stopping dev server for /tmp/claude/dev-server-test-1766695799020

 [32mâœ“[39m tests/unit/services/dev-server-service.test.ts[2m > [22mdev-server-service.ts[2m > [22mstopAll[2m > [22mshould stop all running servers[33m 704[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2merror handling[2m > [22m[2mshould continue auto loop after feature error
[22m[39m[AutoMode] Executing feature fail-1 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-QVjOPe
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature fail-1 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2merror handling[2m > [22m[2mshould continue auto loop after feature error
[22m[39m[AutoMode] Feature fail-1 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2merror handling[2m > [22m[2mshould continue auto loop after feature error
[22m[39m[AutoMode] Executing feature success-1 with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-QVjOPe
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature success-1 with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2merror handling[2m > [22m[2mshould continue auto loop after feature error
[22m[39m[AutoMode] Feature success-1 execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould execute feature with skip planning mode
[22m[39m[AutoMode] Executing feature skip-plan-feature with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-Fs29Fg
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature skip-plan-feature with model: claude-opus-4-5-20251101, planningMode: skip, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould execute feature with skip planning mode
[22m[39m[AutoMode] Feature skip-plan-feature execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould execute feature with lite planning mode without approval
[22m[39m[AutoMode] Executing feature lite-plan-feature with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-YmacHV
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature lite-plan-feature with model: claude-opus-4-5-20251101, planningMode: lite, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould execute feature with lite planning mode without approval
[22m[39m[AutoMode] Feature lite-plan-feature execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould emit planning_started event for spec mode
[22m[39m[AutoMode] Executing feature spec-plan-feature with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-Rmd4H0
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature spec-plan-feature with model: claude-opus-4-5-20251101, planningMode: spec, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould emit planning_started event for spec mode
[22m[39m[AutoMode] Parsed 0 tasks from spec for feature spec-plan-feature

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould emit planning_started event for spec mode
[22m[39m[AutoMode] Spec generated for feature spec-plan-feature, auto-approving (requirePlanApproval=false)
[AutoMode] Making continuation call after plan approval for feature spec-plan-feature

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould emit planning_started event for spec mode
[22m[39m[AutoMode] No parsed tasks, using single-agent execution for feature spec-plan-feature

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould emit planning_started event for spec mode
[22m[39m[AutoMode] Implementation completed for feature spec-plan-feature

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould emit planning_started event for spec mode
[22m[39m[AutoMode] Feature spec-plan-feature execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould handle feature with full planning mode
[22m[39m[AutoMode] Executing feature full-plan-feature with model: claude-opus-4-5-20251101 in /tmp/claude/automaker-test-ztyuaX
[ModelResolver] Using full Claude model string: claude-opus-4-5-20251101
[AutoMode] runAgent called for feature full-plan-feature with model: claude-opus-4-5-20251101, planningMode: full, requiresApproval: false
[AutoMode] Using provider "claude" for model "claude-opus-4-5-20251101"

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould handle feature with full planning mode
[22m[39m[AutoMode] Parsed 0 tasks from spec for feature full-plan-feature

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould handle feature with full planning mode
[22m[39m[AutoMode] Spec generated for feature full-plan-feature, auto-approving (requirePlanApproval=false)
[AutoMode] Making continuation call after plan approval for feature full-plan-feature

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould handle feature with full planning mode
[22m[39m[AutoMode] No parsed tasks, using single-agent execution for feature full-plan-feature

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould handle feature with full planning mode
[22m[39m[AutoMode] Implementation completed for feature full-plan-feature

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould handle feature with full planning mode
[22m[39m[AutoMode] Feature full-plan-feature execution ended, cleaning up runningFeatures
[AutoMode] Pending approvals at cleanup: none

[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould cancel pending approval gracefully
[22m[39m[AutoMode] cancelPlanApproval called for feature non-existent
[AutoMode] Current pending approvals: none
[AutoMode] No pending approval to cancel for feature non-existent

 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22merror handling[2m > [22mshould continue auto loop after feature error[33m 5018[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mplanning mode[2m > [22mshould execute feature with skip planning mode[32m 19[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mplanning mode[2m > [22mshould execute feature with lite planning mode without approval[32m 14[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mplanning mode[2m > [22mshould emit planning_started event for spec mode[32m 15[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mplanning mode[2m > [22mshould handle feature with full planning mode[32m 14[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mplanning mode[2m > [22mshould track pending approval correctly[32m 13[2mms[22m[39m
 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mplanning mode[2m > [22mshould cancel pending approval gracefully[32m 13[2mms[22m[39m
[90mstdout[2m | tests/integration/services/auto-mode-service.integration.test.ts[2m > [22m[2mauto-mode-service.ts (integration)[2m > [22m[2mplanning mode[2m > [22m[2mshould resolve approval with error for non-existent feature
[22m[39m[AutoMode] resolvePlanApproval called for feature non-existent, approved=true
[AutoMode] Current pending approvals: none
[AutoMode] No pending approval in Map for feature non-existent
[AutoMode] ERROR: No pending approval found for feature non-existent and recovery not possible

 [32mâœ“[39m tests/integration/services/auto-mode-service.integration.test.ts[2m > [22mauto-mode-service.ts (integration)[2m > [22mplanning mode[2m > [22mshould resolve approval with error for non-existent feature[32m 13[2mms[22m[39m

[2m Test Files [22m [1m[32m35 passed[39m[22m[90m (35)[39m
[2m      Tests [22m [1m[32m723 passed[39m[22m[90m (723)[39m
[2m   Start at [22m 21:49:50
[2m   Duration [22m 12.46s[2m (transform 5.14s, setup 990ms, import 6.08s, tests 21.24s, environment 3ms)[22m

